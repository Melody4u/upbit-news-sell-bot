# Upbit
UPBIT_ACCESS_KEY=
UPBIT_SECRET_KEY=
MARKET=KRW-BTC

# Safety
DRY_RUN=true
SELL_RATIO=0.25
BUY_RATIO=0.25
MIN_SELL_KRW=5000
MIN_BUY_KRW=5000
CHECK_SECONDS=180

# Strategy score engine
SIGNAL_SCORE_THRESHOLD=3
BUY_SCORE_THRESHOLD=3

# Risk mode auto-switch
# aggressive: <= RISK_AGGRESSIVE_MAX, conservative: >= RISK_CONSERVATIVE_MIN
RISK_AGGRESSIVE_MAX=30
RISK_CONSERVATIVE_MIN=61
AGG_SIGNAL_SCORE_THRESHOLD=2
AGG_BUY_SCORE_THRESHOLD=2
AGG_SELL_RATIO=0.20
AGG_BUY_RATIO=0.30
CONS_SIGNAL_SCORE_THRESHOLD=2
CONS_BUY_SCORE_THRESHOLD=4
CONS_SELL_RATIO=0.35
CONS_BUY_RATIO=0.10
ENTRY_MODE=confirm_breakout
BREAKOUT_GATE_MODE=and
PROBE_ENTRY_RATIO=0.15
BREAKOUT_LOOKBACK=20
MTF_TREND_INTERVAL=minute30
MTF_TREND_INTERVAL_2=minute240
MTF_TREND_LOOKBACK=120

# Phase A: MTF score sizing
ENABLE_MTF_SCORE_SIZING=true
# minute consensus (AND): recommended minute3,minute5,minute15
MINUTE_CONSENSUS_INTERVALS=minute3,minute5,minute15
# hour score weights (total 100)
HOUR_MTF_WEIGHT_M30=15
HOUR_MTF_WEIGHT_H1=20
HOUR_MTF_WEIGHT_H4=30
HOUR_MTF_WEIGHT_D1=20
HOUR_MTF_WEIGHT_W1=15
# score -> stage thresholds
MTF_STAGE_SCOUT_MIN=30
MTF_STAGE_LIGHT_MIN=50
MTF_STAGE_MEDIUM_MIN=65
MTF_STAGE_HEAVY_MIN=80
# stage sizing (equity fraction)
MTF_STAGE_SCOUT_PCT=0.01
MTF_STAGE_LIGHT_PCT=0.07
MTF_STAGE_MEDIUM_PCT=0.15
MTF_STAGE_HEAVY_PCT=0.25

# Stops
ENTRY_STOP_ATR_MULT=2.5
HARD_STOP_PCT=0.10

MIN_RR=3.0
RR_TARGET_ATR_MULT=2.0
ATR_REGIME_MIN_PCT=0.6
ATR_REGIME_MAX_PCT=4.0
SPREAD_BPS_MAX=12
POST_ENTRY_COOLDOWN_BARS=3
PARTIAL_TP_LEVELS=1.0,2.0
PARTIAL_TP_RATIOS=0.3,0.3
MOVE_STOP_TO_BE_AFTER_TP1=true
BE_OFFSET_BPS=8
BE_MOVE_MODE=hybrid           # always|weak_only|hybrid
BE_STRONG_STOP_R=-0.2         # in strong ctx: lift stop to entry + R*risk0 (negative keeps room below entry)

# Early fail cut (high win-rate exits)
EARLY_FAIL_CUT_ENABLED=true
EARLY_FAIL_MODE=hybrid         # weak_trend_only|always|hybrid
EARLY_FAIL_LEVELS_R=0.6,0.9,1.2,1.6,2.0
EARLY_FAIL_CUT_RATIOS=0.1,0.3,0.5,0.7,1.0
EARLY_FAIL_STRONG_LEVELS_R=1.6,2.0
EARLY_FAIL_STRONG_CUT_RATIOS=0.5,1.0

# Filters
DOWNTREND_BLOCK_ENABLED=true
FIB_PULLBACK_ENABLED=false
FIB_LOOKBACK=120
FIB_MIN=0.382
FIB_MAX=0.618
FIB_SWING_CONFIRM=true
VOL_SPIKE_BLOCK_ENABLED=true
VOL_SPIKE_BLOCK_ATR_MULT=2.0

TRAILING_STOP_MODE=atr
TRAILING_ATR_MULT=2.5
TRAILING_APPLY_TO_REMAINDER_ONLY=true
TRADE_COOLDOWN_SECONDS=120
EMERGENCY_SELL_BYPASS_IDEMPOTENCY=true
STOP_BY_ENTRY_CANDLE=true
TAKE_PROFIT_BY_MA22=true
MA_EXIT_PERIOD=22
BOX_LOOKBACK=40
BOX_BUFFER_PCT=0.003
ENABLE_RETEST_ADDON=true
ADDON_RATIO=0.10
TRADE_LOG_PATH=logs/trade_journal.jsonl
RUNTIME_STATE_PATH=logs/runtime_state.json
MARKET_RISK_PATH=logs/market_risk.json
MAX_DRAWDOWN_PCT=0.10
MAX_YEARLY_STOP_COUNT=3
MAX_DAILY_LOSS_PCT=0.10
MAX_CONSECUTIVE_LOSSES=3
MAX_TRADES_PER_DAY=20
MAX_POSITION_KRW=0
MAX_POSITION_FRACTION=0.85
MAX_SLIPPAGE_BPS=16
RISK_PER_TRADE=0.015
EMA_FAST=20
EMA_SLOW=50
ADX_PERIOD=14
ADX_MIN=20
DONCHIAN_PERIOD=20
ATR_PERIOD=14
ATR_MULT=2.5
RSI_PERIOD=14
RSI_OVERBOUGHT=70
RSI_OVERSOLD=30
VOL_PERIOD=20
VOL_SPIKE_MULT=1.8
VWMA_PERIOD=100
LOSS_CUT_PCT=0.02

# MA(20/200) method from your video summary
MA_SHORT=20
MA_LONG=200
MA_SLOPE_LOOKBACK=5
SQUEEZE_GAP_PCT=0.01
SQUEEZE_LOOKBACK=5
BREAKOUT_BODY_ATR_MULT=1.2
SIDEWAYS_LOOKBACK=30
SIDEWAYS_CROSS_THRESHOLD=3

# Plan C: Optional limit entry (default keeps market behavior)
BUY_ENTRY_ORDER_MODE=market      # market|limit
BUY_LIMIT_OFFSET_BPS=5.0         # +bps is more aggressive (fills faster), -bps is more passive
BUY_LIMIT_TIMEOUT_SEC=15
BUY_LIMIT_PRICE_TICK_METHOD=ceil
UPBIT_FEE_RATE=0.0005
BUY_LIMIT_VOLUME_DECIMALS=8
BUY_LIMIT_TIMEOUT_ACTION=skip    # skip only (no fallback)

# Brave News filter
BRAVE_API_KEY=
NEWS_QUERY=bitcoin OR btc OR upbit
NEWS_COUNTRY=KR
NEWS_LANG=ko
NEWS_RESULT_COUNT=5
NEWS_INTERVAL_SECONDS=3600
NEGATIVE_NEWS_THRESHOLD=2

# Alerts / observability
LOG_LEVEL=INFO
ALERT_WEBHOOK_URL=
ALERT_EVENTS=order_sent,filled,rejected,halted,resume
PENDING_ORDER_TIMEOUT_SEC=180

# Dashboard
DASHBOARD_PORT=8787
DASHBOARD_AUTO_OPEN=true
